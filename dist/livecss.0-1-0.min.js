// Live CSS, Dynamic CSS module for AngularJS
// > 0.1.0
// > ofzza, 2015.
// > build: Sat Mar 21 2015 03:36:32
!function(){"use strict";try{angular.module("LCSS")}catch(a){angular.module("LCSS",["ng"])}var b=[function(){return c.$get=function(){return c},c}];angular.module("LCSS").provider("LCSSGlobals",b);var c={$debug:!1,$scope:null}}(),function(){"use strict";var a=!1;try{angular.module("LCSS")}catch(b){angular.module("LCSS",["ng"])}var c=["LCSSGlobalsProvider",function(b){return a=b.$debug,j.$get=function(){return j},j}];angular.module("LCSS").provider("LCSSRuntime",c);var d={},e=function(b,c){return d[b]?(a&&console.error("> [LCSSRuntime]: ",'Failed registering document [hash="'+b+'"]  - duplicate found!'),d[b]):(d[b]=c,g(c),a&&console.log("> [LCSSRuntime]: ",'Registered document [hash="'+b+'"]'),i(),c)},f=function(b){return d[b]?(delete d[b],a&&console.log("> [LCSSRuntime]: ",'Unregistered document [hash="'+b+'"]'),!0):(a&&console.error("> [LCSSRuntime]: ",'Failed unregistering document [hash="'+b+'"]  - hash not registered!'),!1)},g=function(b){b.$scope.$watch(function(){a&&console.log("> [LCSSRuntime]: ",'Scope $digest called on [hash="'+b.$hash+'"]');for(var c in d)d[c].syntax.$processing||d[c].syntax.$awaiting!=d[c].syntax.$await.none||d[c].$refresh()})},h=!1,i=function(){h||(h=!0,setTimeout(function(){h=!1,a&&console.log("> [LCSSRuntime]: ","Running a processing cycle ...");for(var b in d){var c=d[b];c.syntax.$processing||(c.syntax.$awaiting==c.syntax.$await.compilation?c.compile():c.syntax.$awaiting==c.syntax.$await.linking&&c.link())}}))},j={run:function(){i()},document:{register:e,unregister:f,getByHash:function(a){return d[a]},getByProperty:function(){}}}}(),function(){"use strict";var a=!1;try{angular.module("LCSS")}catch(b){angular.module("LCSS",["ng"])}var c=["LCSSGlobalsProvider",function(b){return a=b.$debug,d.$get=function(){return f},d}];angular.module("LCSS").provider("LCSSExtension",c);var d={create:function(a,b,c){return new g(a,b,c)}},e={},f={get:function(a){a=a&&a instanceof Array?a:[a],0==a.length&&a.push(null);for(var b={},c=0;c<a.length;c++)for(var d in e)(!a[c]||e[d].global||"string"==typeof a[c]&&d.length>=a[c].length&&d.substr(0,a[c].length)==a[c])&&(b[d]=e[d]);var f=[];for(var c in b)f.push(b[c]);return f}},g=function(b,c,d){for(var f=this.path=b.split("."),g=0;g<this.path.length;g++)this.path[g]=this.path[g].trim();this.global=d||!1;var h={syntax:{loading:c&&c.syntax&&"function"==typeof c.syntax.loading?c.syntax.loading:null,compilation:c&&c.syntax&&"function"==typeof c.syntax.compilation?c.syntax.compilation:null},resource:{"static":c&&c.resource&&"function"==typeof c.resource["static"]?c.resource["static"]:null,dynamic:c&&c.resource&&"function"==typeof c.resource.dynamic?c.resource.dynamic:null}};this.syntax={loading:function(a){return h.syntax.loading?h.syntax.loading(a):a},compilation:function(a){return h.syntax.compilation?h.syntax.compilation(a):a}};var i=null,j=function(a){i=a;for(var b in k)l(k[b],i)};this.resource={"static":function(){if(h.resource["static"]){i=h.resource["static"]();for(var a in k)l(k[a],i);return!0}return!1},dynamic:function(){return h.resource.dynamic?(h.resource.dynamic(j),!0):!1}};var k={};this.subscribe=function(c,d){a&&console.log('> [LCSSExtension "'+b+'"]: ','Subscribed document [hash="'+c+'"]'),k[c]=d,i&&l(d,i)},this.unsubscribe=function(c){a&&k[c]&&console.log('> [LCSSExtension "'+b+'"]: ','Unsubscribed document [hash="'+c+'"]'),delete k[c]};var l=function(a,b){for(var c=a.$scope,d=0;d<f.length-1;d++)c[f[d]]||(c[f[d]]={}),c=c[f[d]];c[f[f.length-1]]=b,a.$refresh()};e[b]=this,this.resource["static"](),this.resource.dynamic(),a&&console.log('> [LCSSExtension "'+b+'"]: ',"Created")}}(),function(){"use strict";var a=!1;try{angular.module("LCSS")}catch(b){angular.module("LCSS",["ng"])}var c=["LCSSGlobalsProvider","LCSSRuntimeProvider",function(b,c){return a=b.$debug,d=b,e=c,h.$get=["LCSSExtension",function(a){return f=a,h}],h}];angular.module("LCSS").provider("LCSSDocument",c);var d=!1,e=!1,f=!1,g={"import":[]},h=function(b,c){if(!d||!d.$scope)throw new Error("A new LiveCss Document can only be created during AngularJS runtime phase!");var g=this.$scope=d.$scope.$new();c=c||{};var h=this.parameters=i(b,c,g),m=this.$hash=g.$$lcss=j(b.innerHTML),n=e.document.register(m,this);if(n===this){{var o=this.$hostEl=new l(this);this.syntax=new p(m,this,b.innerHTML)}this.$refresh=new k(this);{var r=q(this),s=(this.compile=r.compile,this.link=r.link,this),t=g.$watch(function(){return h["import"]},function(a,b){for(var c=f.get(b),d=0;d<c.length;d++)c[d].unsubscribe(m);for(var e=f.get(a),d=0;d<e.length;d++)e[d].subscribe(m,s)},!0),u=this.$unload=function(){t(),g.$destroy(),o.destroy(),a&&console.log('> [LCSSDocument "'+m+'"]: ',"Unloaded!!")};this.$destroy=function(){for(var b=f.get(),c=0;c<b.length;c++)b[c].unsubscribe(m);e.document.unregister(m),u(),a&&console.log('> [LCSSDocument "'+m+'"]: ',"Destroyed!!")}}}else g.$destroy();return{hash:function(){return n.$hash},parameters:n.parameters,$scope:n.$scope,syntax:n.syntax,$destroy:n.$destroy}};h.defaultParameters=g,h.target=document.head;var i=function(a,b,c){var d={};for(var e in g)d[e]=g[e];for(var f=["watch"],h=0;h<a.attributes.length;h++)d[a.attributes[h].name]=f.indexOf(a.attributes[h].name)>-1?a.attributes[h].value:c.$eval(a.attributes[h].value);for(var e in b)d[e]=b[e];return d},j=function(a){var b=0;if(0==a.length)return b;for(var c=0;c<a.length;c++){var d=a.charCodeAt(c);b=(b<<5)-b+d,b&=b}return"$LCSS:"+b.toString()},k=function(b){var c=b.$scope.$new(!0),d={};for(var f in c)d[f]=!0;c.$destroy();var g=function(a){var b={};for(var c in a)d[c]||(b[c]=a[c]);return b},h=!1,i=null;return function(){h||(h=!0,setTimeout(function(){h=!1;var c=b.parameters.watch?b.$scope.$eval(b.parameters.watch):g(b.$scope);typeof i==typeof c&&angular.equals(i,c)||(a&&console.log('> [LCSSDocument "'+b.$hash+'"]: ',"Detected $scope changes!"),i=c,b.syntax.$awaiting=b.syntax.$await.linking,e.run())}))}},l=function(b){var c=h.target,d=document.createElement("livecss-document");d.setAttribute("hash",b.$hash);var e={url:"syntaxUrl","import":"import"};if(a)for(var f in e)d.setAttribute(f,b.parameters[e[f]]||null);d.style.display="none",c.appendChild(d);var g=document.createElement("style");d.appendChild(g),this.element=function(){return d},this.update=function(a){g.innerHTML=a},this.destroy=function(){c.removeChild(d)}},m={none:!1,compilation:1,linking:2},n={loaded:"compilation",compiled:"linking",linked:"none"},o={loaded:"loading",linked:"compilation"},p=function(b,c,d){var g=this;for(var h in n)!function(d){var h=n[d],i=null;Object.defineProperty(g,d,{get:function(){return i},set:function(g){if(i!==g){if(a&&console.log('> [LCSSDocument "'+b+'"]: ',"Awaiting next processing stage: "+h),i=g,o[d])for(var j=c.parameters["import"],k=f.get(j),l=0;l<k.length;l++)i=k[l].syntax[o[d]](i);this.$awaiting=this.$await[h],c.$hostEl.update(i),this.$awaiting!==this.$await.none&&e.run()}else this.$awaiting=this.$await.none}})}(h);var i=!1;Object.defineProperty(this,"$awaiting",{get:function(){return i},set:function(a){i=a}});var j=!1;Object.defineProperty(this,"$processing",{get:function(){return j},set:function(a){j=a}}),this.loaded=d};p.prototype.$await=m;var q=function(b){var c={compilation:{},linking:{},interpolation:{}},d={linkedEl:null,$scope:null},e=function(){d.$scope.$digest(),d.$scope.$destroy(),setTimeout(f)},f=function(){if(a){console.log('> [LCSSDocument "'+b.$hash+'"]: ',"Linking ..."),c.linking.count||(c.linking.count=0),c.linking.count++,c.compilation.compilationEl.attr("linking-iteration",c.linking.count);var e=new Date;c.compilation.compilationEl.attr("linking-timestamp",e.toTimeString())}b.syntax.linked=d.linkedEl[0].innerHTML,b.syntax.$processing=!1,d.linkedEl.remove()};return{compile:function(){if(b.syntax.$processing=!0,c.compilation.$compile||(c.compilation.$compile=angular.injector(["LCSS"]).get("$compile")),c.compilation.compilationEl||(c.compilation.compilationEl=angular.element("<lcss-compilation>"+b.syntax.loaded+"</lcss-compilation>"),angular.element(b.$hostEl.element()).append(c.compilation.compilationEl)),a){console.log('> [LCSSDocument "'+b.$hash+'"]: ',"Compiling ..."),c.compilation.count||(c.compilation.count=0),c.compilation.count++,c.compilation.compilationEl.attr("compilation-iteration",c.compilation.count);var d=new Date;c.compilation.compilationEl.attr("compilation-timestamp",d.toTimeString()),c.compilation.compilationEl.attr("linking-iteration",null),c.compilation.compilationEl.attr("linking-iteration",null)}b.syntax.compiled=c.compilation.$compile(c.compilation.compilationEl),b.syntax.$processing=!1},link:function(){b.syntax.$processing=!0,b.syntax.compiled?b.syntax.compiled(b.$scope.$new(),function(a,b){d.linkedEl=a,d.$scope=b,setTimeout(e)}):(b.syntax.$processing=!1,this.compile())}}}}(),function(){"use strict";var a=!1;try{angular.module("LCSS")}catch(b){angular.module("LCSS",["ng"])}angular.module("LCSS").provider("LCSSParser",[function(){return{$get:c}}]);var c=["$http","$q","LCSSGlobals","LCSSDocument",function(b,c,e,f){a=e.$debug;var g=function(e){e=e||f.defaultParameters;var g=c.defer();if(e.syntax){var h=d(e.syntax,e,f);a&&console.log("> [LCSSParser]: ","Loaded "+h.length+" documents from raw syntax"),g.resolve(h)}else if(e.syntaxUrl)b.get(e.syntaxUrl).then(function(b){var c=d(b.data,e,f);a&&console.log("> [LCSSParser]: ","Loaded "+c.length+' documents from "'+e.syntaxUrl+'"'),g.resolve(c)},function(a){throw g.reject(),new Error('Failed loading LiveCSS syntax from "'+e.syntaxUrl+'":',a)});else{var h=d(null,e,f);a&&console.log("> [LCSSParser]: ","Loaded "+h.length+" documents from empty syntax"),g.resolve(h)}return g.promise};return g}],d=function(a,b,c){var d=document.createElement("syntax");d.innerHTML=a;for(var e=[],f=[],g=0;g<d.childNodes.length;g++)"#text"===d.childNodes[g].nodeName?f.push(d.childNodes[g].textContent):"#comment"===d.childNodes[g].nodeName?f.push("/*"+d.childNodes[g].textContent+"*/"):e.push(d.childNodes[g]);for(var h="",g=0;g<f.length;g++){var i=f[g].trim();i&&i.length&&(h+=i+"\r\n")}if(h&&h.trim().length){var j=document.createElement("style");j.innerHTML="\r\n"+h.trim()+"\r\n",e.push(j)}var k=[];for(var g in e)k.push(new c(e[g],b));return k}}(),function(){"use strict";var a=!1;try{angular.module("LCSS")}catch(b){angular.module("LCSS",["ng"])}var c={};angular.module("LCSS").directive("lcss",["LCSSGlobals",function(b){return a=b.$debug,{scope:!1,restrict:"EA",link:function(b,d,e){var f=angular.injector(["LCSS"]).get("LCSS"),g=e.src?b.$eval(e.src):null;f.parse({syntax:g?null:d[0].innerHTML,syntaxUrl:g?g:null}).then(function(b){a&&console.log("> [LCSSDirective]: ","Loaded and parsed documents:",b);for(var e=0;e<b.length;e++)a&&console.log("> [LCSSDirective]: ",'Registering document [hash="'+b[e].hash()+'"]'),c[b[e].hash()]||(c[b[e].hash()]=0),c[b[e].hash()]+=1;d.on("$destroy",function(){for(var d=0;d<b.length;d++)a&&console.log("> [LCSSDirective]: ",'Unregistering document [hash="'+b[d].hash()+'"]'),c[b[d].hash()]&&(c[b[d].hash()]-=1),c[b[d].hash()]<=0&&(c[b[d].hash()]=0,b[d].$destroy())})},function(a){throw new Error("Failed loading/parsing LiveCSS by directive"+(g?' from "'+g+'"!':"!"),a)})}}}])}(),function(){"use strict";var a=!1;try{angular.module("LCSS")}catch(b){angular.module("LCSS",["ng"])}var c=function(){return d.$get=function(){return d},d};angular.module("LCSS").provider("LCSS",c);var d={},e={config:!1,run:!1};angular.module("LCSS").config(["LCSSGlobalsProvider","LCSSDocumentProvider",function(b,c){e.config||(a=b.$debug,d.$debug=a=b.$debug=!1,Object.defineProperty(d,"$debug",{get:function(){return b.$debug},set:function(c){a=b.$debug=c}}),d.Document=d.Doc=c,d.target=function(a){c.target=a},e.config=!0)}]),angular.module("LCSS").run(["LCSSGlobals","LCSSDocument","LCSSParser","$rootScope",function(a,b,c,f){e.run||(d.parse=c,d.Document=d.Doc=b,f.LCSS=a.$scope=f.$new(),e.run=!0)}])}(),function(){"use strict";var a=!1;angular.module("LCSS").config(["$compileProvider","LCSSGlobalsProvider",function(b,c){a=c.$debug;var d=0;b.directive("interpolate",["$interpolate","LCSSRuntime",function(a,b){return{restrict:"EA",compile:function(c){d++;var e=c[0].innerHTML,f=null,g="/* $interpolation:start:"+d+" */",h="/* $interpolation:end:"+d+" */";c[0].innerHTML=g+" "+e+" "+h;var i=0,j=0;return function(c){{var d=b.document.getByHash(c.$$lcss),k=!1;d.$scope.$on("$$lcss-refresh",function(){d.syntax.$awaiting,k||(k=!0,setTimeout(function(){k=!1;var b=a(e)(c);if(b!=f){f=b;var l=d.syntax.linked;if(l){var m=d.syntax.$awaiting;i=i>-1?i:0,j=j>-1?j:0,i=l.indexOf(g,i)+g.length,i>g.length&&(j=l.indexOf(h,i),j>i&&(l=l.substr(0,i)+b+l.substr(j))),d.syntax.linked=l,d.syntax.$awaiting=m}}}))})}}}}}])}])}(),function(){"use strict";var a=!1;angular.module("LCSS").config(["LCSSGlobalsProvider","LCSSExtensionProvider",function(b,c){a=b.$debug,c.create("Math",{resource:{"static":function(){return Math}}},!0)}])}(),function(){"use strict";var a=!1;angular.module("LCSS").config(["LCSSGlobalsProvider","LCSSExtensionProvider",function(b,c){a=b.$debug,c.create("Mouse",{resource:{dynamic:function(a){document.addEventListener("mousemove",function(b){a({position:{absolute:{x:b.clientX,y:b.clientY},relative:{x:b.clientX/window.innerWidth,y:b.clientY/window.innerHeight}}})})}}})}])}(),function(){"use strict";var a=!1;angular.module("LCSS").config(["LCSSGlobalsProvider","LCSSExtensionProvider",function(b,c){a=b.$debug,c.create("Window",{resource:{dynamic:function(a){var b=function(){a({size:{width:window.innerWidth,height:window.innerHeight}})};window.addEventListener("resize",b),b()}}})}])}(),function(){"use strict";var a=!1;angular.module("LCSS").config(["LCSSGlobalsProvider","LCSSExtensionProvider",function(b,c){a=b.$debug;var d=document.createElement("lcss-cleardom-extension"),e=function(a){for(var b=[],c=0;c<a.childNodes.length;c++){if("#text"==a.childNodes[c].nodeName)b.push(a.childNodes[c].textContent);else if("#comment"==a.childNodes[c].nodeName)b.push("/* "+a.childNodes[c].textContent+"*/");else for(var d=e(a.childNodes[c]),f=0;f<d.length;f++)b.push(d[f]);a.removeChild(a.childNodes[c])}return b};c.create("lcss.ClearDOM",{syntax:{compilation:function(a){d.innerHTML=a;for(var b=e(d),c="",f=0;f<b.length;f++)c+=b[f];return c}}},!0)}])}();